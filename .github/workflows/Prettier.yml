name: Prettier
on:
  workflow_call:
    inputs:
      subrepo:
        required: true
        type: string
jobs:
  prettier:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v5
        with:
          fetch-depth: 0

      - name: prettier
        # TODO: Ideally we would use the upstream version, but that is broken for a number of reasons.
        uses: Zopolis4/reviewdog-action-prettier@8982f2dd22b76752053312a122a06fdba163a240
        with:
          fail_level: any
          filter_mode: nofilter
          # TODO: All the reporters are broken, including this one, because they do not properly fail on errors.
          # This one prints the errors in the CI logs and fails when prettier detects errors, so its good enough for now.
          reporter: github-pr-review
          workdir: ${{ inputs.subrepo }}
